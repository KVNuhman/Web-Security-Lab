# Lab: Exploiting XXE using external entities to retrieve files

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/53496827-6d00-4a0d-9b46-3bc4eb954bed)

## Solution

The product page has a stock check feature.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/1f269aa7-3d2b-4a93-99fa-252dcab081f8)

The application checks for the stock level of a product by submitting XML to the server:

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/4c9888e5-2fe3-4a01-8da8-8fbe14208ed2)

Insert the following external entity definition in between the XML declaration and the `stockCheck` element:

`<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>`
Replace the `productId` number with a reference to the external entity: `&xxe;`. The response should contain "Invalid product ID:" followed by the contents of the `/etc/passwd` file.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/e67a0175-9dc5-4c24-a99f-63e327f7826d)

Fetching the `/etc/passwd` file solves the lab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/0c0ae992-0fed-4b64-bb28-15d94abb40d0)
