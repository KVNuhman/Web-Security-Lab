# Lab: Exploiting XInclude to retrieve files

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/f81e06e0-cef5-44f0-851e-f0209145e72e)

## Solution

The application has a product stock check endpoint.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/63566f60-dcb6-4947-b2eb-e88c398b254e)

The number of stock is being checked by a `productId` parameter.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/ff618c25-22ff-420f-b5f0-30ac5c18306a)

Set the value of the `productId` parameter to:

`<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>`

This retrieves the `/etc/passwd` file.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/4d982953-82fe-47e8-96cb-1b04674958c7)

Retrieving the `/etc/passwd` solves the lab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/4c0cf22f-0c1b-4579-8caf-437bdc7e019c)
