# Lab: SSRF with filter bypass via open redirection vulnerability

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/b453ac47-f5b2-4453-9d1f-e4c3ad37db66)

## Solution

The prodcut has a stockApi parameter for checking stocks.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/2addca8e-2012-42c8-b8ad-997c4559f362)

Changing the URL for stockApi doesn't make the server issue the request directly to a different host.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/0282adcc-3e39-45d8-96dd-83be44e35357)

The page has a feature that takes the user to the next product on the list.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/44051783-7976-40ee-89de-7ceccb732fc2)

This feature uses path redirection to get the product.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/8a49d84e-2f2d-4a32-80bf-8667002511af)

Change the URL in stockApi parameter to the path of `GET` request from the next product request and the request goes through.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/38d1ed92-c431-48de-8aad-f5defd86d8e2)

Change the URL in stockApi paremter to `/product/nextProduct?path=http://192.168.0.12:8080/admin` . The request goes through and the admin panel is visible. The IP `192.168.0.12` can be found by brute forcing as done in [Lab 02: Basic SSRF against another back-end system](<https://github.com/KVNuhman/Web-Security-Lab/blob/main/Server-side%20request%20forgery%20(SSRF)/Lab%2002%3A%20Basic%20SSRF%20against%20another%20back-end%20system.md>).

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/d7c665aa-b046-4031-aee6-13a5517d9c25)

Use `/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos` to delete user carlos and finish the lab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/20b21c5d-f7fa-4a5b-8f7d-7a979ec376f9)
